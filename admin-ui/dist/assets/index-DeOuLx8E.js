import{_ as $,j,i as E,h as _,H as F,N as M,r as s,o as O,c as z,b as d,a as e,w as t,e as k,t as C,d as H,O as S,F as T}from"./index-C5uf1WvN.js";import{l as q,a as G,d as J}from"./index-lnzsT0Yf.js";import{h as L}from"./confirm-CxKUQBJO.js";import{a as Q,d as W}from"./notification-DhcrVVnz.js";const X={class:"mt-box"},Y={class:"key-box card-box"},Z=["onClick"],ee={class:"value-box"},le={__name:"index",setup(te){const w=j(),o=E({value:void 0,key:void 0,expire:3600}),x=_([]);let v=!0;async function f(){if(v)try{v=!1;const a=await q();a.code===200&&(x.value=a.data)}catch{}finally{v=!0}}const u=_(!1);function g(a){(!a.children||a.children.length===0)&&w.push({name:"cacheInfo",params:{key:a.allKey}})}function I(a){L(async()=>{const l=await J(a);W(l,()=>{f()})})}function N(){o.value=void 0,o.key=void 0,o.expire=3600,u.value=!0}async function U(){const a=await G(o);Q(a,()=>{f(),u.value=!1})}const y=_(2);let i;function b(){i=setInterval(()=>{f()},1e3*y.value)}const r=_(!0);function K(){i?(clearInterval(i),i=void 0,r.value=!1):(b(),r.value=!0)}return b(),F(()=>{f()}),M(()=>{clearInterval(i)}),(a,l)=>{const m=s("el-input"),c=s("el-form-item"),p=s("el-button"),h=s("el-form"),A=s("el-tree"),D=s("el-icon"),B=s("router-view"),P=s("el-dialog");return O(),z(T,null,[d("div",X,[d("div",Y,[e(h,{inline:""},{default:t(()=>[e(c,{label:"自动刷新"},{default:t(()=>[e(m,{modelValue:y.value,"onUpdate:modelValue":l[0]||(l[0]=n=>y.value=n),type:"number",disabled:r.value},null,8,["modelValue","disabled"])]),_:1}),e(c,null,{default:t(()=>[e(p,{onClick:K,type:r.value?"danger":""},{default:t(()=>[k(C(r.value?"停止":"启动")+"自动刷新 ",1)]),_:1},8,["type"])]),_:1})]),_:1}),e(A,{style:{"max-width":"600px"},data:x.value,"node-key":"allKey","default-expand-all":"","expand-on-click-node":!1},{default:t(({node:n,data:V})=>[d("span",{class:"custom-tree-node",onClick:R=>g(V)},[d("span",null,C(n.key),1),d("span",null,[e(p,{type:"text",icon:"Delete",onClick:R=>I(V)},null,8,["onClick"])])],8,Z)]),_:1},8,["data"])]),d("div",{class:"key-btn",onClick:N},[e(D,{size:"80"},{default:t(()=>[e(H(S))]),_:1})]),d("div",ee,[e(B)])]),e(P,{modelValue:u.value,"onUpdate:modelValue":l[5]||(l[5]=n=>u.value=n),title:"新增缓存",width:"600"},{footer:t(()=>[e(p,{onClick:l[4]||(l[4]=n=>u.value=!1)},{default:t(()=>[k("取 消")]),_:1}),e(p,{type:"primary",onClick:U},{default:t(()=>[k("确 定")]),_:1})]),default:t(()=>[e(h,{"label-width":"60"},{default:t(()=>[e(c,{label:"key"},{default:t(()=>[e(m,{modelValue:o.key,"onUpdate:modelValue":l[1]||(l[1]=n=>o.key=n)},null,8,["modelValue"])]),_:1}),e(c,{label:"value"},{default:t(()=>[e(m,{modelValue:o.value,"onUpdate:modelValue":l[2]||(l[2]=n=>o.value=n),type:"textarea",rows:"10"},null,8,["modelValue"])]),_:1}),e(c,{label:"expire"},{default:t(()=>[e(m,{modelValue:o.expire,"onUpdate:modelValue":l[3]||(l[3]=n=>o.expire=n),type:"number"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},de=$(le,[["__scopeId","data-v-96c088ba"]]);export{de as default};

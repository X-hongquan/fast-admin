import{G as C,j as L,h as p,i as w,L as P,H as j,r as n,o as m,C as c,w as s,a as l,c as B,F,k as E,e as G,J as H,Z as J,$ as M,a0 as O}from"./index-C_vwRkRb.js";import{g as S}from"./index-BF9nV_KJ.js";import{a as Z,b as $,d as q}from"./validate-D2IKykPn.js";import{a as z,u as D}from"./notification-D2_ThX_3.js";const ee={__name:"index",setup(K){const i=C(),f=L(),d=p(""),e=w({username:"",avatar:"",roles:[],email:"",password:"",status:1,createTime:"",updateTime:""}),_=p([]),b=p(null),V=w({username:[{validator:Z,trigger:"change"}],password:[{validator:$,trigger:"change"}],roles:[{validator:q,trigger:"change"}]});function v(){let o={id:e.id||void 0,username:e.username,roles:e.roles.map(a=>({id:a})),email:e.email||void 0,password:e.password||void 0,status:e.status||void 0};return console.log(o),o}async function g(o){const a=await O(o);if(a.code===200){Object.assign(e,a.data);let r=[];for(const u of e.roles)r.push(u.id);e.roles=r}}async function U(){const o=await S();o.code===200&&(_.value=o.data)}async function k(){if(d.value==="add"){await b.value.validate();const o=await J(v());z(o,()=>{f.push({name:"user"})})}else if(d.value==="edit"){const o=await M(v());D(o,()=>{f.push({name:"user"})})}}return P(()=>i.name,()=>{if(d.value=i.name.split("-")[1],i.params.userId){let o=i.params.userId;g(o)}},{immediate:!0}),j(()=>{U()}),(o,a)=>{const r=n("el-input"),u=n("el-form-item"),y=n("el-avatar"),R=n("el-option"),T=n("el-select"),x=n("el-switch"),I=n("el-button"),N=n("el-form"),h=n("el-col"),A=n("el-row");return m(),c(A,null,{default:s(()=>[l(h,{span:10},{default:s(()=>[l(N,{"label-width":"100",model:e,rules:V,ref_key:"userRef",ref:b},{default:s(()=>[l(u,{label:"用户名",prop:"username"},{default:s(()=>[l(r,{modelValue:e.username,"onUpdate:modelValue":a[0]||(a[0]=t=>e.username=t),disabled:d.value==="detail"},null,8,["modelValue","disabled"])]),_:1}),l(u,{label:"头像"},{default:s(()=>[l(y,{src:e.avatar,disabled:d.value==="detail"},null,8,["src","disabled"])]),_:1}),l(u,{label:"角色",prop:"roles"},{default:s(()=>[l(T,{modelValue:e.roles,"onUpdate:modelValue":a[1]||(a[1]=t=>e.roles=t),multiple:"",placeholder:"Select",style:{width:"240px"},disabled:d.value==="detail"},{default:s(()=>[(m(!0),B(F,null,E(_.value,t=>(m(),c(R,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),l(u,{label:"邮箱"},{default:s(()=>[l(r,{modelValue:e.email,"onUpdate:modelValue":a[2]||(a[2]=t=>e.email=t),disabled:d.value==="detail"},null,8,["modelValue","disabled"])]),_:1}),l(u,{label:"状态"},{default:s(()=>[l(x,{"active-value":1,"inactive-value":"0",modelValue:e.status,"onUpdate:modelValue":a[3]||(a[3]=t=>e.status=t),disabled:d.value==="detail"},null,8,["modelValue","disabled"])]),_:1}),l(u,{label:"密码",prop:"password"},{default:s(()=>[l(r,{type:"password",modelValue:e.password,"onUpdate:modelValue":a[4]||(a[4]=t=>e.password=t),disabled:d.value==="detail","show-password":""},null,8,["modelValue","disabled"])]),_:1}),l(u,{label:"创建时间"},{default:s(()=>[l(r,{modelValue:e.createTime,"onUpdate:modelValue":a[5]||(a[5]=t=>e.createTime=t),disabled:""},null,8,["modelValue"])]),_:1}),l(u,{label:"更新时间"},{default:s(()=>[l(r,{modelValue:e.updateTime,"onUpdate:modelValue":a[6]||(a[6]=t=>e.updateTime=t),disabled:""},null,8,["modelValue"])]),_:1}),d.value==="add"||d.value==="edit"?(m(),c(u,{key:0},{default:s(()=>[l(I,{type:"primary",onClick:k},{default:s(()=>[G("提交")]),_:1})]),_:1})):H("",!0)]),_:1},8,["model","rules"])]),_:1})]),_:1})}}};export{ee as default};
